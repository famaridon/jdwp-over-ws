language: java

env:
  - MAVEN_POM_VERSION=

cache:
  directories:
  - $HOME/.m2

before_install:
  - ./travis-ci/parse-pom.sh
  - echo MAVEN_POM_VERSION=$MAVEN_POM_VERSION

install: # the build step
   - mvn clean install -B -V

deploy:
  provider: releases
  api_key: $GITHUB_OAUTH_TOKEN
  file_glob: true
  file:
  - "jdwp-over-ws-server/target/tcp-over-ws*.war"
  - "jdwp-over-ws-client/target/jdwp-over-ws-client*.jar"
  skip_cleanup: true
  on:
    tags: true


notifications:
  email: # only receive email when the build status changes (someone broke the build!)
    on_failure: change
    on_success: change

